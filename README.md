# test_task_max

Написать сервис, который будет сообщать насколько имя подходит человеку по его фотографии.
Сервис должен быть обернут в Docker контейнер. Для контроля зависимостей важно использовать composer.
Нельзя использовать какой либо фреймворк целиком, но можно спокойно использовать его части, либо любые другие библиотеки любых других разработчиков.

Сервис должен иметь одну точку входа (localhost:8000), которая может принимать два типа запроса:
1) POST запрос, с содержимым типа multipart/form-data, с полями name и photo.
2) GET запрос, с обычным query параметром task_id

Результатом запроса должны быть:
1) Загружена фотография во временную папку
2) Проверено, не отправлял ли этот пользователь уже эту фотографию, в этом случае вернуть результат и status=ready.
2) Создана задача и записана в БД/Хранилище
3) Отдан ответ json (с соответствующим http кодом ответа):
{"status": "received", "task": НОМЕР_ЗАДАЧИ, "result":"null или Результат_(float)"}

Сервис должен сразу вернуть ответ и в фоне запустить дальнейшую работу:
1) Отправить POST запрос, с содержимым типа multipart/form-data на http://merlinface.com:12345/api/ с телом, содержащим:
[
  'name' => "Имя",
  'photo' => файл фотографии, созданный посредством curl_file_create(),
]

2) Получить и обработать два варианта ответа
  а)  Результат готов сразу:
    {"status": "ready", "result": "Результат_(float)"}
  б)  Требуется время, запросите результат через пару секунд
    {"status": "wait", "result": null, "retry_id": id_задачи_для_повторного_запроса}
    
В случае варианта "а", нужно:
- отметить что задача с номером НОМЕР_ЗАДАЧИ была выполнена
- записать результат

В случае варианта "б", нужно:
- повторять запрос через пару секунд, но уже вместо фотографии и имени отправить поле retry_id со значением retry_id, полученного в ответе варианта "б". 
  До тех пор, пока не будет получен ответ:
  {"status": "ready", "result": "Результат_(float)"}
- отметить что задача с номером НОМЕР_ЗАДАЧИ была выполнена
- записать результат

При обращении к конечной точке сервиса(для получения результата) посредством GET запроса /?task_id=НОМЕР_ЗАДАЧИ, должен быть отдан один из трех вариантов ответов:
1)  Результат еще не готов  (с соответствующим http кодом ответа)
  {"status": "wait", "result": null}
2)  Результат готов (с соответствующим http кодом ответа)
  {"status": "ready", "result": "Результат_(float)"}
3)  Задача с таким номером не найдена (с соответствующим http кодом ответа)
  {"status": "not_found", "result": null}
